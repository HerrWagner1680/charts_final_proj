<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
<link rel="stylesheet" type="text/css" href="chart.css">
	<title>sampler - a copy of loopy_js.html</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>

<script type="text/javascript">

 google.load("visualization", '1', {packages:['corechart']});
 google.setOnLoadCallback(drawsamplerChart);

function drawsamplerChart() {
  var query = new google.visualization.Query(
  'https://docs.google.com/spreadsheet/ccc?key=0Atw2BTU52lOCdEZpUlVIdmxGOWZBR2tuLXhYN2dQTWc&usp=drive_web&gid=0#');

  query.send(samplerResponse);
}

function samplerResponse(response) {
  if (response.isError()) {
    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }

  var data = response.getDataTable();
 
  var options = {
    'title': ($('input[name=chart_title]').val()),
    vAxis: {title: ($('input[name=col_a_label]').val())},
    hAxis: {title: ($('input[name=col_b_label]').val())},
              'width':500,
              'height':400
            };
  var chart = new google.visualization.ColumnChart(document.getElementById('chart_div0'));

    exportCode (data);

    $("#col2").attr('checked', 'checked'); // selecting columnchart radio button for sampler

    //disabling the unrelated radio buttons for sampler
    $("input[class=no_val_val]").attr('disabled', false);
    $("input[class=no_string]").attr('disabled', true);

    chart.draw( data, options);

    //$(document).scrollTop(0); //document scrolls to top of page
}

</script>

<title>Data from a Spreadsheet</title>
</head>

<body>

<!--div that will hold the charts-->
<br>
<div id="chart_div0"></div>
<br>

<button id="refresh">Refresh (redraw chart)</button>
<br>
<br>
<!-- radio buttons -->
  <p id="select_typ">select a type of chart</p>

  <br>

  <input id="area2" class="no_val_val" type="radio" name="chart_type" value="area"><label for="area2">area</label></button>
  <input id="bar2" class="no_val_val" type="radio" name="chart_type" value="bar"><label for="bar2">bar</label>
  <input id="step2" class="no_val_val" type="radio" name="chart_type" value="step"><label for="step2">step</label>
  <input id="col2" class="no_val_val" type="radio" name="chart_type" value="column"><label for="col2">column</label>
  <input id="line2" class="no_val_val" type="radio" name="chart_type" value="line"><label for="line2">line</label>
  <input id="donut2" class="no_val_val" type="radio" name="chart_type" value="donut"><label for="donut2">pie / donut</label>
  <input id="pie2" class="no_val_val" type="radio" name="chart_type" value="pie"><label for="pie2">pie 3D</label>
  <input id="scatter2" class="no_string" type="radio" name="chart_type" value="scatter"><label for="scatter2">scatter</label>
  <input id="lin2" class="no_string" type="radio" name="chart_type" value="trend_lin"><label for="lin2">trend: linear</label>
  <input id="exp2" class="no_string" type="radio" name="chart_type" value="trend_exp"><label for="exp2">trend: exponential</label>
  <input id="poly2" class="no_string" type="radio" name="chart_type" value="trend_poly"><label for="poly2">trend: polynomial</label>
  <br>
<!-- END OF RADIO BUTTONS -->

<!-- DATA FORM -->
  <p>TITLE OF CHART:  <input type="text" name="chart_title" value="Title"></p>

  <td><input type="text" id="col_a_label" name="col_a_label" value="Axis 1"></td>
  <td><input type="text" id="col_b_label" name="col_b_label" value="Axis 2"></td>

  <p>
    <select id="dataType_col_a" name="dataType_col_a" required>
    <option value = ""> - select data type - </option>
    <option value = "string">string</option>
    <option value = "number">number</option>
    </select>

    <select id="dataType_col_b" name="dataType_col_b" required>
    <option value = "number">number</option>
    <option value = ""> - select data type - </option>
<!--<option value = "string">string</option> -->
    </select>

<!--<select id="dataType_col_c" name="dataType_col_c" required>
    <option value = "number">number</option>
    <option value = ""> - select data type - </option> -->
<!--<option value = "string">string</option> -->
<!--     </select>

    <select id="dataType_col_d" name="dataType_col_d" required>
    <option value = "number">number</option>
    <option value = ""> - select data type - </option> -->
<!--<option value = "string">string</option> 
    </select> -->
  </p>

  <br>
  <input type="text" id="cell_1a" name="cell_1a" value="">
  <input type="text" id="cell_1b" name="cell_1b" value="">
<!--   <input type="text" id="cell_1c" name="cell_1c" value="">
  <input type="text" id="cell_1d" name="cell_1d" value=""> -->
  <br>
  <input type="text" id="cell_2a" name="cell_2a" value="">
  <input type="text" id="cell_2b" name="cell_2b" value="">
<!--   <input type="text" id="cell_2c" name="cell_2c" value="">
  <input type="text" id="cell_2d" name="cell_2d" value=""> -->
  <br>
  <input type="text" id="cell_3a" name="cell_3a" value="">
  <input type="text" id="cell_3b" name="cell_3b" value="">
<!--   <input type="text" id="cell_3c" name="cell_3c" value="">
  <input type="text" id="cell_3d" name="cell_3d" value=""> -->
  <br>
  <input type="text" id="cell_4a" name="cell_4a" value="">
  <input type="text" id="cell_4b" name="cell_4b" value="">
<!--   <input type="text" id="cell_4c" name="cell_4c" value="">
  <input type="text" id="cell_4d" name="cell_4d" value=""> -->
<!-- END OF DATA FORM -->

<br>
<br>


<h3>UPLOAD GRID DATA FROM GOOGLE SHEET URL</h3>

  <form NAME="myform" onSubmit="JavaScript:ExampleJS()">
  <input  type="url" id="spreadsheet_file" name="spreadsheet_file" size="30">
  <input type="submit" value="Upload URL">
  </form>
<br>
<br>

<!-- export code -->
  <h5>EXPORT CODE</h5>
  <textarea name="export_code" cols=80 rows=25></textarea>
<!-- end of export code -->
<br>
<br>

<script type="text/javascript" src="sampler9jan2.js"></script>

<script>




var jUrl = "https://docs.google.com/spreadsheet/ccc?key=0Atw2BTU52lOCdEZpUlVIdmxGOWZBR2tuLXhYN2dQTWc&usp=drive_web&gid=0#";
//perhaps you should only ask for the goog sheet key?
//ignore columns of strings after row a

//https://docs.google.com/spreadsheets/d/15tPYmvsQvHmSdyPp-wzw92lQZdhoM9QGJ-zR-2_k5PA/pubhtml
//https://docs.google.com/spreadsheets/d/15tPYmvsQvHmSdyPp-wzw92lQZdhoM9QGJ-zR-2_k5PA/edit?usp=sharing
//https://docs.google.com/spreadsheet/tq?key=15tPYmvsQvHmSdyPp-wzw92lQZdhoM9QGJ-zR-2_k5PA
//WORKS://https://docs.google.com/spreadsheets/d/15tPYmvsQvHmSdyPp-wzw92lQZdhoM9QGJ-zR-2_k5PA/gviz/tq

// all charts must be public and published to web (have in instructions? or error message?)
  //simple column chart - IT WORKS!
      // https://docs.google.com/spreadsheet/ccc?key=0Atw2BTU52lOCdEZpUlVIdmxGOWZBR2tuLXhYN2dQTWc&usp=drive_web&gid=0#

//metals 
// https://docs.google.com/spreadsheet/ccc?key=0AiFfbdok-kQKcENRYmV0ZC1DcHRIbndKRWZvOHRBTEE#gid=0 //metals

// https://docs.google.com/spreadsheet/tq?key=0AiFfbdok-kQKcENRYmV0ZC1DcHRIbndKRWZvOHRBTEE  //metals 

// https://docs.google.com/spreadsheet/ccc?key=0Atw2BTU52lOCdEZpUlVIdmxGOWZBR2tuLXhYN2dQTWc&usp=drive_web&gid=0#   

//gathering data from upload url window
function handleQueryResponse(response) {
  if (response.isError()) {
    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }

    // console.log("below is TITLE in handleQueryResponse")
    // console.log($('#docs-title-inner')) // title of sheet

  var data = response.getDataTable();


    $("#dataType_col_a").val(data.Pf[0].type) // string or number
    $("#dataType_col_b").val(data.Pf[1].type)
    // $("#dataType_col_c").val(data.Pf[2].type) // string or number
    // $("#dataType_col_d").val(data.Pf[3].type)
     // console.log(data.Pf[0].type)
     // console.log(data.Pf[1].type)

    $("#col_a_label").attr("value", data.Pf[0].label) // column name
    $("#col_b_label").attr("value", data.Pf[1].label)
  //     console.log(data.Nf[1].c[0].v)
  //     console.log(data.Nf[1].c[1].v)
    $("#cell_1a").attr("value", data.Nf[0].c[0].v) //first row
    $("#cell_1b").attr("value", data.Nf[0].c[1].v)
    // $("#cell_1c").attr("value", data.Nf[0].c[2].v)
    // $("#cell_1d").attr("value", data.Nf[0].c[3].v)

    $("#cell_2a").attr("value", data.Nf[1].c[0].v) //second row
    $("#cell_2b").attr("value", data.Nf[1].c[1].v)
    // $("#cell_2c").attr("value", data.Nf[1].c[2].v)
    // $("#cell_2d").attr("value", data.Nf[1].c[3].v)

    $("#cell_3a").attr("value", data.Nf[2].c[0].v) //third row
    $("#cell_3b").attr("value", data.Nf[2].c[1].v)
    // $("#cell_3c").attr("value", data.Nf[2].c[2].v)
    // $("#cell_3d").attr("value", data.Nf[2].c[3].v)

    $("#cell_4a").attr("value", data.Nf[3].c[0].v) //fourth row
    $("#cell_4b").attr("value", data.Nf[3].c[1].v)
    // $("#cell_4c").attr("value", data.Nf[3].c[2].v)
    // $("#cell_4d").attr("value", data.Nf[3].c[3].v)
  // //need to have ? true or if else in case object null,nil

}



function SheetRefresh() { 
	console.log("showing jUrl: " + jUrl);

  var query = new google.visualization.Query(jUrl);
  query.send(handleQueryResponse);

}

function ExampleJS(){
	event.preventDefault();
	jUrl = document.getElementById("spreadsheet_file").value;
    console.log("Grabbing File")
    console.log(jUrl);

    $('#spreadsheet_file').val(null) //clears the upload url window
    SheetRefresh();
 }

SheetRefresh();

</script>

</body>
</html>