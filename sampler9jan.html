<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
<!-- 	<link rel="stylesheet" type="text/css" href="iframe_chart.css"> -->
	<title>sampler - a copy of loopy_js.html</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>

<script type="text/javascript">

 google.load("visualization", '1', {packages:['corechart']});
 google.setOnLoadCallback(drawsamplerChart);

function drawsamplerChart() {
  var query = new google.visualization.Query(
  //NOTE - DO NOT SUBMIT WITH EDIT IN URL !!!!!
 // 'https://docs.google.com/spreadsheets/d/1vonOpz2D-z_I_IZA-sHoHHy4BDesFXbTgLZgw7iIf5s/edit#gid=0');
 'https://docs.google.com/spreadsheet/ccc?key=0Atw2BTU52lOCdEZpUlVIdmxGOWZBR2tuLXhYN2dQTWc&usp=drive_web&gid=0#');

 query.send(samplerResponse);
}

function samplerResponse(response) {
  if (response.isError()) {
    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }

  var data = response.getDataTable();
      console.log(data.Pf[0].type)
      console.log(data.Pf[1].type)

      console.log(data.Nf[1].c[0].v)
      console.log(data.Nf[1].c[1].v)
      console.log(data.Nf[2].c[0].v)
      console.log(data.Nf[2].c[1].v)
      console.log(data.Nf[3].c[0].v)
      console.log(data.Nf[3].c[1].v)



  var chart = new google.visualization.ColumnChart(document.getElementById('columnchart'));

     chart.draw( data, {'width':600, 'height':500});

}


</script>

<title>Data from a Spreadsheet</title>
</head>

<body>

<span id='columnchart'></span>


<IFRAME SRC="" WIDTH=800 HEIGHT=300></IFRAME>


<h3>UPLOAD GOOGLE SPREADSHEET URL   .......  UPLOAD BUTTON</h3>

<form NAME="myform" onSubmit="JavaScript:ExampleJS()">
 <input  type="url" id="spreadsheet_file" name="spreadsheet_file" size="30">
  <input type="submit" value="Upload URL">
</form>

<script>


var jUrl = "https://docs.google.com/spreadsheet/ccc?key=0Atw2BTU52lOCdEZpUlVIdmxGOWZBR2tuLXhYN2dQTWc&usp=drive_web&gid=0#";

  //simple column chart - IT WORKS!
      // 'https://docs.google.com/spreadsheet/ccc?key=0Atw2BTU52lOCdEZpUlVIdmxGOWZBR2tuLXhYN2dQTWc&usp=drive_web&gid=0#');

// https://docs.google.com/spreadsheet/ccc?key=0AiFfbdok-kQKcENRYmV0ZC1DcHRIbndKRWZvOHRBTEE#gid=0 //metals


// 'https://docs.google.com/spreadsheet/tq?key=0AiFfbdok-kQKcENRYmV0ZC1DcHRIbndKRWZvOHRBTEE');  //metals - IT WORKS!



//var jUrl = "https://docs.google.com/spreadsheet/ccc?key=0Atw2BTU52lOCdEZpUlVIdmxGOWZBR2tuLXhYN2dQTWc&usp=drive_web&gid=0#";

// var jUrl = "https://docs.google.com/spreadsheets/d/1vonOpz2D-z_I_IZA-sHoHHy4BDesFXbTgLZgw7iIf5s/edit#gid=0";

function handleQueryResponse(response) {
  if (response.isError()) {
    alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
    return;
  }

  var data = response.getDataTable();
      console.log(data.Pf[0].type)
      console.log(data.Pf[1].type)

      console.log(data.Nf[1].c[0].v)
      console.log(data.Nf[1].c[1].v)
      console.log(data.Nf[2].c[0].v)
      console.log(data.Nf[2].c[1].v)
      console.log(data.Nf[3].c[0].v)
      console.log(data.Nf[3].c[1].v)


  var chart = new google.visualization.ColumnChart(document.getElementById('columnchart'));

     chart.draw( data, {'width':600, 'height':500});

}



function SheetRefresh() { 
	console.log(jUrl);
	$("iframe").attr("src", jUrl );

  var query = new google.visualization.Query(jUrl);
  query.send(handleQueryResponse);

}

function ExampleJS(){
	event.preventDefault();
	jUrl = document.getElementById("spreadsheet_file").value;
    console.log("Grabbing File")
    console.log(jUrl);
    SheetRefresh();
 }

SheetRefresh();

</script>

</body>
</html>